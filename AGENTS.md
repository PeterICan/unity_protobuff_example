# AGENTS.mdï¼šå°ˆæ¡ˆå”ä½œæŒ‡å—èˆ‡å¯¦ä½œæ¸…å–®

## ä½¿ç”¨è€…åå¥½

- å°ˆæ¡ˆç›¸é—œçš„ä»»ä½•æ–‡ä»¶ç”¢å‡ºã€è¨è«–ã€è¨»è§£éƒ½è«‹ä½¿ç”¨ä¸­æ–‡ã€‚

## å”ä½œæµç¨‹ (Collaboration Workflow)

- **ä»»å‹™ç¢ºèª**: åœ¨å®Œæˆä¸€å€‹ä¸»è¦ä»»å‹™ï¼ˆä¾‹å¦‚ TODO åˆ—è¡¨ä¸­çš„ä¸€å€‹ç·¨è™Ÿé …ï¼‰å¾Œï¼Œæˆ‘æœƒå‘æ‚¨å ±å‘Šé€²åº¦ã€‚åœ¨ç¹¼çºŒä¸‹ä¸€å€‹ä»»å‹™ä¹‹å‰ï¼Œæˆ‘éœ€è¦å¾—åˆ°æ‚¨çš„ç¢ºèªã€‚è«‹å›è¦†ã€Œå¥½çš„ã€ã€ã€Œç¹¼çºŒã€æˆ–æä¾›é€²ä¸€æ­¥çš„æŒ‡ç¤ºï¼Œä»¥ç¢ºä¿æˆ‘å€‘çš„å”ä½œä¿æŒåŒæ­¥ã€‚

## å°ˆæ¡ˆç‹€æ…‹èˆ‡æ ¸å¿ƒç›®æ¨™

| é …ç›® | æè¿° | ç‹€æ…‹ |
| :--- | :--- | :--- |
| **å°ˆæ¡ˆåç¨±** | æ‡‰ç”¨å±¤é€šè¨ŠæŠ½è±¡èˆ‡å”å®šå¯¦é©—å°ˆæ¡ˆ | è¦åŠƒèª¿æ•´ |
| **ç›®æ¨™** | å¯¦ä½œä¸€å€‹**é›™é‡è§£è€¦**çš„ Server/Client æ¶æ§‹ï¼Œå¯¦é©— **Protobuf/TCP** èˆ‡ **JSON/WebSocket** å…©ç¨®é€šè¨Šæ¨¡å¼ã€‚ | å·²ç¢ºèª |
| **æ ¸å¿ƒæŠ€è¡“** | Go Server (**antnet æ¡†æ¶**) / Unity Client / Protobuf / JSON | å·²ç¢ºèª |

---

## æ ¸å¿ƒè¨­è¨ˆç†å¿µï¼šé›™é‡æŠ½è±¡ (Decoupling)

æœ¬å°ˆæ¡ˆå°‡æ¥­å‹™é‚è¼¯èˆ‡é€šè¨Šç´°ç¯€åˆ†é›¢æˆå…©å±¤æŠ½è±¡ã€‚**æ³¨æ„ï¼šåœ¨æ–°çš„è¨ˆç•«ä¸­ï¼ŒServer ç«¯çš„æŠ½è±¡å±¤ç”± `antnet` æ¡†æ¶æä¾›ï¼Œæˆ‘å€‘çš„å·¥ä½œæ˜¯ä½¿ç”¨å…¶ APIã€‚Client ç«¯ä»éœ€è‡ªè¡Œå¯¦ç¾æŠ½è±¡å±¤ã€‚**

| æŠ½è±¡å±¤ | è² è²¬åŠŸèƒ½ | é—œéµä»‹é¢ (ç¤ºä¾‹) | æ›¿æ›å¯¦ä½œ (æ¨¡å¼ I / æ¨¡å¼ II) |
| :--- | :--- | :--- | :--- |
| **è³‡æ–™æ ¼å¼** | è™•ç†åŸç”Ÿæ¨¡å‹èˆ‡äºŒé€²ä½/æ–‡å­—é–“çš„è½‰æ›ã€‚ | `ISerializer` | ProtobufSerializer / JSONSerializer |
| **å‚³è¼¸å”å®š** | è™•ç†ç¶²è·¯é€£ç·šã€Socket I/O æˆ– WebSocket è«‹æ±‚ã€‚ | `IConnection` | TCPTransport / WebSocketTransport |

---

## ğŸ“‹ æ¥ä¸‹ä¾†çš„ TODO åˆ—è¡¨ (Next Steps) - *å·²èª¿æ•´ç‚ºä½ç½®å„ªå…ˆçš„é–‹ç™¼é †åº*

### éšæ®µä¸€ï¼šåŸºç¤è¨­å®š (1-2)

| # | ä»»å‹™ | æè¿° | é æœŸè¼¸å‡ºæª”æ¡ˆ/ç‹€æ…‹ | ç‹€æ…‹ |
| :--- | :--- | :--- | :--- | :--- |
| 1 | **æª¢æŸ¥ç¾æœ‰ Go Server ç‹€æ…‹** | æª¢æŸ¥ `server/go.mod` å’Œ `server/main.go` çš„ç•¶å‰ç‹€æ…‹ï¼Œç¢ºèª antnet ä¾è³´æ˜¯å¦æ­£ç¢ºè¨­å®š | ç¢ºèªç¾æœ‰è¨­å®šç‹€æ…‹ | âœ… å·²å®Œæˆ |
| 2 | **æ›´æ–° antnet ä¾è³´è¨­å®š** | ç¢ºä¿ `server/go.mod` ä¸­åŒ…å«æ­£ç¢ºçš„ antnet ä¾è³´ï¼Œå¦‚éœ€è¦å‰‡åŸ·è¡Œ `go get` æ›´æ–° | `server/go.mod` æ›´æ–° | âœ… å·²å®Œæˆ |

### éšæ®µäºŒï¼šä½ç½®åŠŸèƒ½å„ªå…ˆ (3-9)

| # | ä»»å‹™ | æè¿° | é æœŸè¼¸å‡ºæª”æ¡ˆ | ç‹€æ…‹ |
| :--- | :--- | :--- | :--- | :--- |
| 3 | **å®šç¾©ä½ç½®è³‡æ–™æ¨¡å‹** | åœ¨ `common/types.go` å’Œ `common/Types.cs` ä¸­å®šç¾© `PlayerPosition`ã€`PositionUpdate` ç­‰ä½ç½®ç›¸é—œçš„æ ¸å¿ƒè³‡æ–™çµæ§‹ | `common/types.go`, `common/Types.cs` | âœ… å·²å®Œæˆ |
| 4 | **å»ºç«‹ä½ç½®è™•ç† Handler** | å»ºç«‹ `server/handlers/position.go`ï¼Œè™•ç†ä½ç½®æ›´æ–°å’Œå»£æ’­çš„æ¥­å‹™é‚è¼¯ | `server/handlers/position.go` | âœ… å·²å®Œæˆ |
| 5 | **å¯¦ä½œ antnet TCP ä¼ºæœå™¨è¨­å®š** | æ›´æ–° `server/main.go`ï¼Œè¨­å®š antnet ç›£è½ TCP åŸ ä¸¦ä½¿ç”¨ Protobuf è§£æå™¨è™•ç†ä½ç½®è¨Šæ¯ | `server/main.go` æ›´æ–° | âœ… å·²å®Œæˆ |
| 6 | **å¯¦ä½œ Client ç«¯æŠ½è±¡ä»‹é¢** | åœ¨ Unity Client ä¸­å®šç¾© `ISerializer` å’Œ `IConnection` ä»‹é¢ï¼Œå»ºç«‹æŠ½è±¡å±¤åŸºç¤ | `Client/Scripts/ISerializer.cs`, `Client/Scripts/IConnection.cs` | âœ… å·²å®Œæˆ |
| 7 | **å¯¦ä½œ ProtobufSerializer** | åœ¨ `Client/Scripts/` ä¸­å¯¦ä½œ `ProtobufSerializer.cs`ï¼Œè™•ç† Protobuf æ ¼å¼åºåˆ—åŒ– | `Client/Scripts/ProtobufSerializer.cs` | âœ… å·²å®Œæˆ |
| 8 | **å¯¦ä½œ TCPClientTransport** | åœ¨ `Client/Scripts/` ä¸­å¯¦ä½œ `TCPClientTransport.cs`ï¼Œä½¿ç”¨ TcpClient é€£æ¥åˆ° antnet ä¼ºæœå™¨ | `Client/Scripts/TCPClientTransport.cs` | âœ… å·²å®Œæˆ |
| 9 | **é€²è¡Œ TCP/Protobuf ä½ç½®æ¸¬è©¦** | æ¸¬è©¦ Client ç™¼é€ä½ç½®æ›´æ–°ï¼ŒServer è™•ç†ä¸¦å›æ‡‰çš„å®Œæ•´ TCP æµç¨‹ | åŠŸèƒ½å¯é‹ä½œ | âœ… å·²å®Œæˆ |

### éšæ®µä¸‰ï¼šWebSocket æ¨¡å¼ (10-13)

| # | ä»»å‹™ | æè¿° | é æœŸè¼¸å‡ºæª”æ¡ˆ | ç‹€æ…‹ |
| :--- | :--- | :--- | :--- | :--- |
| 10 | **è¨­å®š antnet WebSocket ç«¯é»** | æ›´æ–° `server/main.go`ï¼Œæ–°å¢ WebSocket ç›£è½åŸ ä¸¦ä½¿ç”¨ JSON è§£æå™¨ | `server/main.go` æ›´æ–° | âœ… å·²å®Œæˆ |
| 11 | **å¯¦ä½œ JSONSerializer** | åœ¨ `Client/Scripts/` ä¸­å¯¦ä½œ `JSONSerializer.cs`ï¼Œè™•ç† JSON æ ¼å¼åºåˆ—åŒ– (JSON Schema æª”æ¡ˆä½æ–¼ `common/json_schema/position.schema.json`ï¼›Client ç«¯å°‡ä½¿ç”¨ `NJsonSchema` å¾ JSON Schema ç”Ÿæˆ C# é¡åˆ¥ï¼›Go å¾Œç«¯å°‡ä½¿ç”¨ `omissis/go-jsonschema` å¾ JSON Schema ç”Ÿæˆçµæ§‹é«”) | `Client/Scripts/JSONSerializer.cs` | âœ… å·²å®Œæˆ |
| 12 | **å¯¦ä½œ WebSocketClientTransport** | åœ¨ `Client/Scripts/` ä¸­å¯¦ä½œ `WebSocketClientTransport.cs`ï¼Œé€£æ¥åˆ° antnet çš„ WebSocket ç«¯é» | `Client/Scripts/WebSocketClientTransport.cs` | âœ… å·²å®Œæˆ |
| 13 | **é€²è¡Œ WebSocket/JSON ä½ç½®æ¸¬è©¦** | æ¸¬è©¦ Client ç™¼é€ä½ç½®æ›´æ–°ï¼ŒServer è™•ç†ä¸¦å»£æ’­çš„å®Œæ•´ WebSocket æµç¨‹ | åŠŸèƒ½å¯é‹ä½œ | âœ… å·²å®Œæˆ |

### éšæ®µå››ï¼šé€šè¨ŠæŒ‡ä»¤ç¢¼å®šç¾© (14-15)

| # | ä»»å‹™ | æè¿° | é æœŸè¼¸å‡ºæª”æ¡ˆ | ç‹€æ…‹ |
| :--- | :--- | :--- | :--- | :--- |
| 14 | **ç‚º WebSocket å®šç¾©ç¨ç«‹æŒ‡ä»¤ç¢¼** | **æœ€çµ‚è¨­è¨ˆæ–¹æ¡ˆï¼š**

**æ ¸å¿ƒç›®æ¨™**ï¼š
å¯¦ç¾ä¸€å€‹**é›™é‡è§£è€¦**çš„ JSON/WebSocket é€šè¨Šæ¨¡å¼ï¼Œä½¿å…¶èˆ‡ Protobuf/TCP æ¨¡å¼å®Œå…¨ç¨ç«‹ï¼Œä¸¦å…·å‚™ Web å‹å¥½çš„ç‰¹æ€§ï¼ŒåŒæ™‚è§£æ±º `antnet` æ¡†æ¶å…§å»º JSON è§£æå™¨çš„æ€§èƒ½ç“¶é ¸ã€‚

**è¨­è¨ˆæ–¹æ¡ˆæ¦‚è¿°**ï¼š

1. **é€šè¨Šå”å®šåŸºç¤ (JSON)**ï¼š
    - æ‰€æœ‰ WebSocket è¨Šæ¯å‡æ¡ç”¨ **JSON æ ¼å¼**ã€‚
    - æ¯å€‹ C2S (Client-to-Server) å’Œ S2C (Server-to-Client) è¨Šæ¯éƒ½åŒ…å«ä¸€å€‹**`route` æ¬„ä½ (å­—ä¸²)**ï¼Œç”¨æ–¼æ˜ç¢ºæŒ‡ç¤ºè¨Šæ¯çš„é¡å‹å’Œé æœŸè™•ç†é‚è¼¯ï¼ˆä¾‹å¦‚ `"position/update"`ï¼‰ã€‚é€™å–ä»£äº†èˆŠ TCP æ¨¡å¼ä¸­çš„ `Cmd`/`Act` æ•´æ•¸çµ„åˆã€‚
    - è¨Šæ¯ä¸­åŒ…å«ä¸€å€‹ `request_id` æ¬„ä½ (å­—ä¸²)ï¼Œç”¨æ–¼éåŒæ­¥è«‹æ±‚èˆ‡å›æ‡‰çš„é—œè¯ï¼Œä½†å…¶åŠŸèƒ½å¯¦ä½œå·²å»¶å¾Œã€‚
    - å®šç¾©äº†æ¨™æº–çš„ `ErrorResponse` çµæ§‹ï¼Œç”¨æ–¼çµ±ä¸€çš„éŒ¯èª¤å›å ±ã€‚

2. **Protobuf æª”æ¡ˆçµæ§‹èˆ‡ç”Ÿæˆ**ï¼š
    - `.proto` æª”æ¡ˆä½œç‚º JSON è¨Šæ¯çš„**çµæ§‹å®šç¾©èªè¨€**ï¼Œç¢ºä¿å‰å¾Œç«¯è³‡æ–™çµæ§‹çš„ä¸€è‡´æ€§ã€‚
    - **æª”æ¡ˆçµ„ç¹”**ï¼š`.proto` æª”æ¡ˆä¾ç…§é‚è¼¯å¥—ä»¶ï¼ˆ`json_api`ï¼‰åˆ†å±¤å­˜æ”¾æ–¼ `common/proto/json_api/` ç›®éŒ„ä¸‹ï¼Œä¾‹å¦‚ `common.api.proto`ã€`position.api.proto`ã€`gamer_info.api.proto`ã€‚
    - **`go_package` è¨­å®š**ï¼š`.proto` æª”æ¡ˆä¸­çš„ `option go_package = "/.;json_api";` ç¢ºä¿ Go ç¨‹å¼ç¢¼èƒ½æ­£ç¢ºç”Ÿæˆåˆ° `server/generated/json_api` å­ç›®éŒ„ã€‚
    - **`import` æ©Ÿåˆ¶**ï¼šé€šç”¨è¨Šæ¯ï¼ˆå¦‚ `ErrorResponse`ï¼‰å®šç¾©åœ¨ `common.api.proto` ä¸­ï¼Œä¸¦è¢«å…¶ä»– `.proto` æª”æ¡ˆå°å…¥ä½¿ç”¨ã€‚
    - **è…³æœ¬èª¿æ•´**ï¼š`generate_go_proto.bat` å’Œ `generate_csharp_proto.bat` è…³æœ¬å·²ä¿®æ”¹ï¼Œä½¿ç”¨ `pushd/popd` å’Œ `protoc` å…©æ¬¡å‘¼å«ï¼ˆåˆ†åˆ¥è™•ç† `message.proto` å’Œ `json_api` ç›¸é—œ `.proto`ï¼‰ï¼Œç¢ºä¿æ‰€æœ‰ `.proto` æª”æ¡ˆéƒ½èƒ½æ­£ç¢ºç”Ÿæˆå°æ‡‰çš„ Go å’Œ C# ç¨‹å¼ç¢¼ã€‚

3. **å®¢æˆ¶ç«¯å¯¦ä½œ (Unity C#)**ï¼š
    - **`JSONSerializer` å¢å¼·**ï¼š
        - ç¹¼çºŒä½¿ç”¨ `Google.Protobuf.JsonFormatter` å’Œ `JsonParser` è™•ç† Protobuf ç”Ÿæˆçš„ C# é¡å‹ã€‚
        - å¼•å…¥ `Newtonsoft.Json` å¥—ä»¶ï¼Œä¸¦åœ¨ `JSONSerializer` ä¸­æ–°å¢ `DeserializeToJObject(byte[] data)` æ–¹æ³•ï¼Œç”¨æ–¼å°‡åŸå§‹ JSON å­—ä¸²è§£æç‚ºé€šç”¨çš„ `JObject`ã€‚
    - **å…©éšæ®µååºåˆ—åŒ–**ï¼š
        1. `OnMessageReceived` å‡½å¼é¦–å…ˆä½¿ç”¨ `DeserializeToJObject` ç²å– `JObject`ï¼Œå¾ä¸­æå– `route` å­—ä¸²ã€‚
        2. æ ¹æ“š `route` çš„å€¼ï¼Œå‹•æ…‹åˆ¤æ–·ç›®æ¨™ `S2C` è¨Šæ¯é¡å‹ï¼Œç„¶å¾Œä½¿ç”¨ `_jsonSerializer.Deserialize<T>(byte[] data)` å°‡åŸå§‹ JSON å®Œæ•´ååºåˆ—åŒ–ç‚ºè©²ç‰¹å®šé¡å‹ã€‚
    - **ç™¼é€è¨Šæ¯**ï¼šC# `C2S` è¨Šæ¯ç‰©ä»¶ï¼ˆä¾‹å¦‚ `C2SPositionUpdate`ï¼‰è¢«å»ºç«‹ï¼Œå…¶ `route` æ¬„ä½è¢«è¨­å®šï¼Œç„¶å¾Œé€é `_jsonSerializer.Serialize` åºåˆ—åŒ–ç‚º JSON å­—ç¯€ç™¼é€ã€‚

4. **ä¼ºæœå™¨ç«¯å¯¦ä½œ (Go `antnet`)**ï¼š
    - **è‡ªå®šç¾©è§£æå™¨ (`JsonRouteParser`)**ï¼š
        - å¯¦ä½œ `server/parser/json_route_parser.go`ï¼Œå®ƒå¯¦ç¾äº† `antnet.IParser` ä»‹é¢ã€‚
        - `JsonRouteParser.ParseC2S` æ–¹æ³•æœƒå…ˆå¾ incoming JSON ä¸­æå– `route`ï¼Œç„¶å¾Œé€éå…§éƒ¨ `routeMap` ç›´æ¥æŸ¥æ‰¾ä¸¦ååºåˆ—åŒ–ç‚ºæ­£ç¢ºçš„ C2S è¨Šæ¯é¡å‹ï¼Œå¯¦ç¾ `O(1)` çš„è§£ææ•ˆç‡ã€‚
        - `JsonRouteParser.PackMsg` è² è²¬å°‡ Go ç‰©ä»¶åºåˆ—åŒ–ç‚º JSON å­—ç¯€ã€‚
    - **`antnet` æ¡†æ¶æ•´åˆ**ï¼š
        - **ä¿®æ”¹ `antnet` åŸå§‹ç¢¼**ï¼šåœ¨ `server/third-party/antnet/parser.go` ä¸­ç‚º `antnet.Parser` çµæ§‹é«”æ·»åŠ äº†å…¬å…±çš„ `SetIParser(p antnet.IParser)` æ–¹æ³•ï¼Œä»¥å…è¨±å¾å¤–éƒ¨è¨­å®šå…¶å…§éƒ¨çš„ `parser` æ¬„ä½ã€‚
        - `server/ws_server.go` åœ¨ `NewWebSocketServer` ä¸­ï¼Œä½¿ç”¨ `baseParser.SetIParser(jsonRouteParser)` å°‡è‡ªå®šç¾©è§£æå™¨æ³¨å…¥ `antnet` æ¡†æ¶ã€‚
        - `JsonRouteParser.RegisterMsg(route string, c2s interface{}, s2c interface{})` æ–¹æ³•ç”¨æ–¼å°‡ `route` å­—ä¸²èˆ‡ C2S/S2C è¨Šæ¯é¡å‹é—œè¯èµ·ä¾†ï¼Œå¡«å…… `JsonRouteParser` å…§éƒ¨çš„ `routeMap`ã€‚
    - **å›æ‡‰è™•ç†**ï¼šè™•ç†å‡½å¼ï¼ˆä¾‹å¦‚ `HandleC2SPositionUpdate`ï¼‰æ‰‹å‹•ä½¿ç”¨ `encoding/json.Marshal` å°‡ S2C å›æ‡‰ç‰©ä»¶åºåˆ—åŒ–ç‚º JSON å­—ç¯€ï¼Œç„¶å¾Œæ”¾å…¥ `antnet.Message` çš„ `Data` æ¬„ä½ä¸­ç™¼é€ã€‚

**è€ƒé‡**ï¼š
- **æ€§èƒ½**ï¼šè‡ªå®šç¾© `JsonRouteParser` é¡¯è‘—æå‡äº†è¨Šæ¯åˆ†ç™¼çš„æ€§èƒ½ã€‚
- **ç¬¬ä¸‰æ–¹ä¿®æ”¹**ï¼šå° `antnet` åŸå§‹ç¢¼é€²è¡Œäº†å°‘é‡ä¿®æ”¹ä»¥å¯¦ç¾æ•´åˆï¼Œé€™æ˜¯ç‚ºäº†è§£æ±ºæ€§èƒ½å•é¡Œè€Œåšå‡ºçš„æ¬Šè¡¡ã€‚ | `common/types.go`, `common/Types.cs` æ›´æ–° | âœ… å·²å®Œæˆ |

| 15 | **å¯¦ä½œè‡ªå®šç¾© JSON è·¯ç”±è§£æå™¨** | ç‚ºäº†é¿å… `antnet` å…§å»º `JsonParser` çš„ã€Œå‹åˆ¥çŒœæ¸¬ã€æ€§èƒ½å•é¡Œï¼Œå¯¦ä½œ `server/parser/json_route_parser.go`ï¼Œä¸¦ä¿®æ”¹ `antnet` åŸå§‹ç¢¼ä»¥æ”¯æ´å…¶æ•´åˆã€‚ | `server/parser/json_route_parser.go`ï¼Œ`server/third-party/antnet/parser.go` ä¿®æ”¹ï¼Œ`server/ws_server.go` æ›´æ–°ã€‚ | âœ… å·²å®Œæˆ |

### éšæ®µäº”ï¼šåŸºç¤ UI (16)

| # | ä»»å‹™ | æè¿° | é æœŸè¼¸å‡ºæª”æ¡ˆ | ç‹€æ…‹ |
| :--- | :--- | :--- | :--- | :--- |
| 16 | **å¯¦ä½œåŸºç¤ Viewer ä»‹é¢** | å»ºç«‹ç°¡åŒ–çš„ `NetworkViewer.cs`ï¼Œå°ˆæ³¨æ–¼ä½ç½®æ›´æ–°åŠŸèƒ½çš„ UI ä»‹é¢æ¸¬è©¦ | `Client/Scripts/NetworkViewer.cs` | â¹ï¸ æœªé–‹å§‹ |

### éšæ®µå…­ï¼šç™»å…¥åŠŸèƒ½ (17-19) - *å»¶å¾ŒåŸ·è¡Œ*

| # | ä»»å‹™ | æè¿° | é æœŸè¼¸å‡ºæª”æ¡ˆ | ç‹€æ…‹ |
| :--- | :--- | :--- | :--- | :--- |
| 17 | **å®šç¾©ç™»å…¥è³‡æ–™æ¨¡å‹** | åœ¨ common ä¸­å®šç¾© `UserCredentials`ã€`LoginResponse` ç­‰ç™»å…¥ç›¸é—œè³‡æ–™çµæ§‹ | æ›´æ–° `common/types.go`, `common/Types.cs` | â¹ï¸ æœªé–‹å§‹ |
| 18 | **å»ºç«‹ç™»å…¥è™•ç† Handler** | å»ºç«‹ `server/handlers/login.go`ï¼Œè™•ç†ç™»å…¥é©—è­‰çš„æ¥­å‹™é‚è¼¯ | `server/handlers/login.go` | â¹ï¸ æœªé–‹å§‹ |
| 19 | **å®Œæ•´ Unity Client Viewer ä»‹é¢** | æ“´å±• NetworkViewerï¼Œæ–°å¢ç™»å…¥é©—è­‰åŠŸèƒ½å’Œå®Œæ•´çš„ UI æ¸¬è©¦ä»‹é¢ | `Client/Scripts/NetworkViewer.cs` æ›´æ–° | â¹ï¸ æœªé–‹å§‹ |

### éšæ®µä¸ƒï¼šæœ€çµ‚æ•´åˆ (20)

| # | ä»»å‹™ | æè¿° | é æœŸè¼¸å‡ºæª”æ¡ˆ | ç‹€æ…‹ |
| :--- | :--- | :--- | :--- | :--- |
| 20 | **æ•´åˆæ¸¬è©¦å’Œæœ€çµ‚é©—è­‰** | é€²è¡Œå®Œæ•´çš„é›™é‡æŠ½è±¡æ¶æ§‹æ¸¬è©¦ï¼Œç¢ºèªæ‰€æœ‰åŠŸèƒ½ï¼ˆä½ç½®+ç™»å…¥ï¼‰æ­£å¸¸é‹ä½œ | åŠŸèƒ½å¯é‹ä½œ | â¹ï¸ æœªé–‹å§‹ |

### éšæ®µå…«ï¼šå¯¦ä½œ request_id (21)

| # | ä»»å‹™ | æè¿° | é æœŸè¼¸å‡ºæª”æ¡ˆ | ç‹€æ…‹ |
| :--- | :--- | :--- | :--- | :--- |
| 21 | **å¯¦ä½œ request_id çš„ç”Ÿæˆèˆ‡è™•ç†** | åœ¨å®¢æˆ¶ç«¯ç”Ÿæˆå”¯ä¸€çš„ `request_id` ä¸¦åŒ…å«åœ¨ C2S è¨Šæ¯ä¸­ï¼Œä¼ºæœå™¨å°‡å…¶å›å‚³æ–¼ S2C è¨Šæ¯ã€‚å®¢æˆ¶ç«¯åˆ©ç”¨ `request_id` é—œè¯è«‹æ±‚èˆ‡å›æ‡‰ã€‚æ­¤åŠŸèƒ½å°‡åœ¨åŸºç¤åŠŸèƒ½ç©©å®šå¾Œå¯¦ä½œã€‚ | Client/Server ç¨‹å¼ç¢¼æ›´æ–°ï¼Œ`request_id` æ¬„ä½å•Ÿç”¨ã€‚ | â¹ï¸ æœªé–‹å§‹ |

### éšæ®µä¹ï¼šæ¶æ§‹é‡æ§‹ (22)

| # | ä»»å‹™ | æè¿° | é æœŸè¼¸å‡ºæª”æ¡ˆ | ç‹€æ…‹ |
| :--- | :--- | :--- | :--- | :--- |
| 22 | **JSON åºåˆ—åŒ–æµç¨‹é‡æ§‹** | ä¿®æ­£ JSON åºåˆ—åŒ–æµç¨‹ï¼Œä½¿å…¶ä½¿ç”¨ç¨ç«‹çš„è³‡æ–™æ¨¡å‹ (POCO æˆ–å¾ JSON Schema ç”Ÿæˆ)ï¼Œä»¥ç¬¦åˆã€Œé›™é‡è§£è€¦ã€çš„æ¶æ§‹ç›®æ¨™ï¼Œè§£æ±ºç›®å‰å° Protobuf ç”Ÿæˆé¡åˆ¥çš„ä¾è³´å•é¡Œã€‚(æ™‚é–“å…è¨±ä¸‹æ‰æœƒé€²è¡Œ) | `Client/Scripts/JSONSerializer.cs` æ›´æ–° | â¹ï¸ æœªé–‹å§‹ |
